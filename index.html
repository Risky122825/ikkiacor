<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <?!= include("Style"); ?>
  </head>
  <body>
    <div class="container">
      <h1>Data Tamu</h1>
      <button onclick="getData()">Tampilkan Data</button>
      <table id="dataTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nama</th>
            <th>Username</th>
            <th>Level</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <script>
      const url = 'https://script.google.com/macros/s/AKfycbxqu2DMLwKCMUEVuX15Wo0C0SPGohsLRLbYP4SPKuJ5Zwjed4-RkdbZx0MRE1V1XtxKOQ/exec?read=true';

      function getData() {
        fetch(url)
          .then(response => response.json())
          .then(data => {
            const tableBody = document.querySelector('#dataTable tbody');
            tableBody.innerHTML = '';
            data.forEach(item => {
              const row = document.createElement('tr');
              row.innerHTML = `
                <td>${item.ID}</td>
                <td>${item.NAMA}</td>
                <td>${item.USERNAME ?? '-'}</td>
                <td>${item.LEVEL ?? '-'}</td>
              `;
              tableBody.appendChild(row);
            });
          })
          .catch(error => {
            console.error('Gagal mengambil data:', error);
            alert('Gagal mengambil data. Cek console untuk detail.');
          });
      }
    </script>
  </body>
</html>
